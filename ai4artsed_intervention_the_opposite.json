{
  "id": "51774992-2cc6-467d-b81d-cbed57895b7f",
  "revision": 0,
  "last_node_id": 51,
  "last_link_id": 78,
  "nodes": [
    {
      "id": 5,
      "type": "EmptyLatentImage",
      "pos": [
        1845.0916748046875,
        886.107421875
      ],
      "size": [
        315,
        106
      ],
      "flags": {},
      "order": 0,
      "mode": 0,
      "inputs": [],
      "outputs": [
        {
          "name": "LATENT",
          "type": "LATENT",
          "slot_index": 0,
          "links": [
            2
          ]
        }
      ],
      "properties": {
        "cnr_id": "comfy-core",
        "ver": "0.3.27",
        "Node name for S&R": "EmptyLatentImage"
      },
      "widgets_values": [
        1024,
        1024,
        1
      ]
    },
    {
      "id": 8,
      "type": "VAEDecode",
      "pos": [
        1511.0772705078125,
        901.7804565429688
      ],
      "size": [
        210,
        46
      ],
      "flags": {},
      "order": 15,
      "mode": 0,
      "inputs": [
        {
          "name": "samples",
          "type": "LATENT",
          "link": 7
        },
        {
          "name": "vae",
          "type": "VAE",
          "link": 8
        }
      ],
      "outputs": [
        {
          "name": "IMAGE",
          "type": "IMAGE",
          "slot_index": 0,
          "links": [
            9
          ]
        }
      ],
      "properties": {
        "cnr_id": "comfy-core",
        "ver": "0.3.27",
        "Node name for S&R": "VAEDecode"
      },
      "widgets_values": []
    },
    {
      "id": 7,
      "type": "CLIPTextEncode",
      "pos": [
        1382.3824462890625,
        1219.0897216796875
      ],
      "size": [
        425.27801513671875,
        180.6060791015625
      ],
      "flags": {},
      "order": 6,
      "mode": 0,
      "inputs": [
        {
          "name": "clip",
          "type": "CLIP",
          "link": 5
        }
      ],
      "outputs": [
        {
          "name": "CONDITIONING",
          "type": "CONDITIONING",
          "slot_index": 0,
          "links": [
            6
          ]
        }
      ],
      "properties": {
        "cnr_id": "comfy-core",
        "ver": "0.3.27",
        "Node name for S&R": "CLIPTextEncode"
      },
      "widgets_values": [
        "text, watermark"
      ]
    },
    {
      "id": 6,
      "type": "CLIPTextEncode",
      "pos": [
        1382.6529541015625,
        1001.113525390625
      ],
      "size": [
        422.84503173828125,
        164.31304931640625
      ],
      "flags": {},
      "order": 12,
      "mode": 0,
      "inputs": [
        {
          "name": "clip",
          "type": "CLIP",
          "link": 3
        },
        {
          "name": "text",
          "type": "STRING",
          "widget": {
            "name": "text"
          },
          "link": 67
        }
      ],
      "outputs": [
        {
          "name": "CONDITIONING",
          "type": "CONDITIONING",
          "slot_index": 0,
          "links": [
            4
          ]
        }
      ],
      "properties": {
        "cnr_id": "comfy-core",
        "ver": "0.3.27",
        "Node name for S&R": "CLIPTextEncode"
      },
      "widgets_values": [
        "beautiful scenery nature glass bottle landscape, , purple galaxy bottle,"
      ]
    },
    {
      "id": 9,
      "type": "SaveImage",
      "pos": [
        1231.7845458984375,
        -859.6812744140625
      ],
      "size": [
        782.6429443359375,
        895.6958618164062
      ],
      "flags": {},
      "order": 16,
      "mode": 0,
      "inputs": [
        {
          "name": "images",
          "type": "IMAGE",
          "link": 9
        }
      ],
      "outputs": [],
      "properties": {
        "cnr_id": "comfy-core",
        "ver": "0.3.27"
      },
      "widgets_values": [
        "ComfyUI",
        ""
      ]
    },
    {
      "id": 4,
      "type": "CheckpointLoaderSimple",
      "pos": [
        -280.12261962890625,
        198.89601135253906
      ],
      "size": [
        730.3237915039062,
        114.64132690429688
      ],
      "flags": {},
      "order": 1,
      "mode": 0,
      "inputs": [],
      "outputs": [
        {
          "name": "MODEL",
          "type": "MODEL",
          "slot_index": 0,
          "links": [
            1
          ]
        },
        {
          "name": "CLIP",
          "type": "CLIP",
          "slot_index": 1,
          "links": [
            3,
            5
          ]
        },
        {
          "name": "VAE",
          "type": "VAE",
          "slot_index": 2,
          "links": [
            8
          ]
        }
      ],
      "title": "Choose your model (or leave the preset)",
      "properties": {
        "cnr_id": "comfy-core",
        "ver": "0.3.27",
        "Node name for S&R": "CheckpointLoaderSimple"
      },
      "widgets_values": [
        "sd3.5_large_fp8_scaled.safetensors"
      ],
      "color": "#232",
      "bgcolor": "#353"
    },
    {
      "id": 3,
      "type": "KSampler",
      "pos": [
        1856.083740234375,
        1077.40966796875
      ],
      "size": [
        352.9214782714844,
        262
      ],
      "flags": {},
      "order": 14,
      "mode": 0,
      "inputs": [
        {
          "name": "model",
          "type": "MODEL",
          "link": 1
        },
        {
          "name": "positive",
          "type": "CONDITIONING",
          "link": 4
        },
        {
          "name": "negative",
          "type": "CONDITIONING",
          "link": 6
        },
        {
          "name": "latent_image",
          "type": "LATENT",
          "link": 2
        }
      ],
      "outputs": [
        {
          "name": "LATENT",
          "type": "LATENT",
          "slot_index": 0,
          "links": [
            7
          ]
        }
      ],
      "properties": {
        "cnr_id": "comfy-core",
        "ver": "0.3.27",
        "Node name for S&R": "KSampler"
      },
      "widgets_values": [
        1088017918249842,
        "randomize",
        20,
        7,
        "euler",
        "normal",
        1
      ]
    },
    {
      "id": 48,
      "type": "PrimitiveStringMultiline",
      "pos": [
        -73.80681610107422,
        -265.1689147949219
      ],
      "size": [
        400,
        200
      ],
      "flags": {},
      "order": 2,
      "mode": 0,
      "inputs": [],
      "outputs": [
        {
          "name": "STRING",
          "type": "STRING",
          "links": [
            72
          ]
        }
      ],
      "properties": {
        "cnr_id": "comfy-core",
        "ver": "0.3.36",
        "Node name for S&R": "PrimitiveStringMultiline"
      },
      "widgets_values": [
        "1. Detect all entities and visual elements in the source image.\n2. Transform each element into its diametrical opposite: female → male, old → young, large → small, red → green, joyful → sorrowful, friendly → hostile, etc. Ensure the inversion is categorical and exhaustive.\n3. Identify all inter-entity relations: spatial (above → below, inside → outside), logical (cause → effect), narrative (protagonist → bystander), and kinship (mother → son or stranger). Invert each relation accordingly.\n4. Reconstruct a coherent image concept using the transformed entities in their reversed relations. Preserve the structural logic of the original while applying full semantic reversal.\n5. Output only the final configuration. Do not include commentary, explanations, or meta-descriptions."
      ],
      "color": "#232",
      "bgcolor": "#353"
    },
    {
      "id": 40,
      "type": "ai4artsed_openrouter",
      "pos": [
        592.4388427734375,
        -589.3604125976562
      ],
      "size": [
        491.4000244140625,
        268
      ],
      "flags": {},
      "order": 8,
      "mode": 0,
      "inputs": [
        {
          "name": "input_prompt",
          "type": "STRING",
          "widget": {
            "name": "input_prompt"
          },
          "link": 76
        },
        {
          "name": "input_context",
          "type": "STRING",
          "widget": {
            "name": "input_context"
          },
          "link": 72
        },
        {
          "name": "api_key",
          "type": "STRING",
          "widget": {
            "name": "api_key"
          },
          "link": 73
        }
      ],
      "outputs": [
        {
          "name": "output",
          "type": "STRING",
          "links": [
            65,
            69
          ]
        }
      ],
      "properties": {
        "aux_id": "joeriben/ai4artsed_comfyui",
        "ver": "0464d155e31fa8ab956aa907e233794cfb04bc70",
        "Node name for S&R": "ai4artsed_openrouter"
      },
      "widgets_values": [
        "",
        "",
        "Transform the image description according to the logic and instructions defined in the input labeled “input_context”.\nThis is not a linguistic translation, but a semantic and structural transformation.\nReconstruct all entities and their relations as specified, ensuring that:\n- Each entity is retained and transformed as instructed.\n- Each relation is inverted or altered in line with the logic of the “Context”.\n- The resulting structure reflects a complete semantic inversion.\nDo not explain your reasoning.\nOutput only the transformed description, either as structured data (if input was structured), or as plain descriptive text (if input was textual).",
        "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",
        "anthropic/claude-3.7-sonnet:thinking",
        "enable"
      ],
      "color": "#322",
      "bgcolor": "#533"
    },
    {
      "id": 42,
      "type": "ai4artsed_openrouter",
      "pos": [
        611.3375854492188,
        -195.33126831054688
      ],
      "size": [
        487.6839294433594,
        334.8896179199219
      ],
      "flags": {},
      "order": 10,
      "mode": 0,
      "inputs": [
        {
          "name": "input_prompt",
          "type": "STRING",
          "widget": {
            "name": "input_prompt"
          },
          "link": 65
        },
        {
          "name": "input_context",
          "type": "STRING",
          "widget": {
            "name": "input_context"
          },
          "link": 66
        },
        {
          "name": "api_key",
          "type": "STRING",
          "widget": {
            "name": "api_key"
          },
          "link": 74
        }
      ],
      "outputs": [
        {
          "name": "output",
          "type": "STRING",
          "links": [
            67,
            70
          ]
        }
      ],
      "properties": {
        "aux_id": "joeriben/ai4artsed_comfyui",
        "ver": "0464d155e31fa8ab956aa907e233794cfb04bc70",
        "Node name for S&R": "ai4artsed_openrouter"
      },
      "widgets_values": [
        "",
        "",
        "Use the input to create a prompt suitable for Stable Diffusion 3.5.\nInstructions:\n1. Select only information that can be rendered visually: entities, their visual properties, spatial configurations, symbolic or narrative roles if they have visual consequences (e.g. pose, gesture, setting, costume).\n2. Ignore non-visual symbolic or abstract relations unless they manifest as visible differences (e.g. \"freedom\" → \"confinement\" becomes \"open field\" → \"prison room\").\n3. Condense the result into a comma-separated prompt with no more than 75 tokens. Use compressed, stylized language typical for SD prompts.\n4. Do not use full sentences. Avoid repetition. Do not include any meta-text or explanation.\n5. Emphasize key compositional and stylistic features if evident (e.g. centered, dramatic lighting, overcast, wide angle, cinematic).\nOutput: Only the resulting prompt as plain text. No table, no explanation, no formatting.\n\nIf the resulting prompt is clearly under 75 tokens, expand it by:\n– adding visually descriptive adjectives (e.g. lighting, texture, motion, color quality)\n– specifying environmental or background elements that imply the mood\n– including camera or compositional hints (e.g. angle, framing, focus)\n– inserting emotional or symbolic indicators only if they have visual impact\n\nDo not pad artificially or repeat. Prioritize meaningful, image-relevant details.",
        "",
        "anthropic/claude-3.7-sonnet:thinking",
        "enable"
      ],
      "color": "#322",
      "bgcolor": "#533"
    },
    {
      "id": 47,
      "type": "PrimitiveStringMultiline",
      "pos": [
        -455.00494384765625,
        -1017.158935546875
      ],
      "size": [
        400,
        200
      ],
      "flags": {},
      "order": 3,
      "mode": 0,
      "inputs": [],
      "outputs": [
        {
          "name": "STRING",
          "type": "STRING",
          "links": [
            75
          ]
        }
      ],
      "title": "ai4artsed_text_input",
      "properties": {
        "cnr_id": "comfy-core",
        "ver": "0.3.36",
        "Node name for S&R": "PrimitiveStringMultiline"
      },
      "widgets_values": [
        "ein Stein auf einem Blatt Papier, das Papier liegt auf einer Kreuzung mitten in der Wüste an einem sonnigen Sommertag. Es weht kein Wind."
      ],
      "color": "#232",
      "bgcolor": "#353"
    },
    {
      "id": 50,
      "type": "ai4artsed_openrouter",
      "pos": [
        -50.1804313659668,
        -672.0159912109375
      ],
      "size": [
        459.9271240234375,
        267.9999694824219
      ],
      "flags": {},
      "order": 7,
      "mode": 0,
      "inputs": [
        {
          "name": "input_prompt",
          "type": "STRING",
          "widget": {
            "name": "input_prompt"
          },
          "link": 75
        },
        {
          "name": "api_key",
          "type": "STRING",
          "widget": {
            "name": "api_key"
          },
          "link": 77
        }
      ],
      "outputs": [
        {
          "name": "output",
          "type": "STRING",
          "links": [
            76,
            78
          ]
        }
      ],
      "title": "item and relation analysis",
      "properties": {
        "aux_id": "joeriben/ai4artsed_comfyui",
        "ver": "fe64c5c981a6053532151e879437df25061dd945",
        "Node name for S&R": "ai4artsed_openrouter"
      },
      "widgets_values": [
        "",
        "",
        "Analyze the image and output exactly two separate tables. Do not include any introductory or explanatory text beyond these tables.\nFirst Table: Visually Observable Entities and Relationships\nFormat:\n| Entity 1 | Relation | Entity 2 | Relation Type |\nInstructions:\n1. Identify all visible or implied entities (people, objects, animals, symbols, elements of the environment, etc.).\n2. For each pair of entities, specify a concrete relation that connects them using clear, unambiguous terms (e.g., \"above\", \"next to\", \"inside\", \"wearing\", \"has color\").\n3. Classify each relation into one of the following types:\n- spatial (e.g., above, next to, inside)\n- temporal (e.g., before, after, simultaneous)\n- causal (e.g., causes, enables, prevents)\n- symbolic (e.g., represents, connotes, expresses)\n- narrative (e.g., protagonist of, is acted upon by, interacts with)\n- social (e.g., mother of, enemy of, supports)\n- property (e.g., has color, has gender, has age, shows emotion)\nSecond Table: Inferred or Interpretative Semantic Relations\nFormat:\n| Subject | Inferred Relation | Object / Value | Type | Source |\nInstructions:\n1. Extract higher-level, inferred semantic relations based on visual cues and contextual hints. These relations can include emotional states, narrative context, symbolic meanings, social dynamics, environmental impressions, temporal cues, or attentional focus.\n2. For each inference, specify the relation clearly and classify it using one of the following types: emotional, narrative, symbolic, social, environmental, temporal, attentional, or other.\n3. In the “Source” column, indicate the origin of the inference (e.g., \"visual cue\", \"contextual inference\", \"cultural trope\", \"associative logic\").\n4. Use one row per relation.\nOutput only the two markdown tables in the specified format.",
        "",
        "anthropic/claude-3.7-sonnet:thinking",
        "enable"
      ],
      "color": "#322",
      "bgcolor": "#533"
    },
    {
      "id": 51,
      "type": "ShowText",
      "pos": [
        -22.76861572265625,
        -1194.365478515625
      ],
      "size": [
        597.748779296875,
        471.0760498046875
      ],
      "flags": {},
      "order": 9,
      "mode": 0,
      "inputs": [
        {
          "name": "text",
          "type": "STRING",
          "widget": {
            "name": "text"
          },
          "link": 78
        }
      ],
      "outputs": [
        {
          "name": "STRING",
          "shape": 6,
          "type": "STRING",
          "links": null
        }
      ],
      "title": "item and relation analysis",
      "properties": {
        "cnr_id": "comfyui-show-text",
        "ver": "1.0.2",
        "Node name for S&R": "ShowText"
      },
      "widgets_values": [
        "",
        "| Entity 1 | Relation | Entity 2 | Relation Type |\n|----------|----------|----------|--------------|\n| Stone | on top of | Paper | spatial |\n| Paper | lying on | Crossroads | spatial |\n| Crossroads | located in | Desert | spatial |\n| Desert | illuminated by | Sun | property |\n| Stone | experiences | No wind | property |\n| Paper | experiences | No wind | property |\n| Desert | experiences | Summer day | temporal |\n| Crossroads | intersects | Desert roads | spatial |\n| Sun | creates | Sunny conditions | causal |\n| Desert | characterized by | Heat | property |\n\n| Subject | Inferred Relation | Object / Value | Type | Source |\n|---------|-------------------|----------------|------|--------|\n| Scene | conveys | Stillness | environmental | visual cue |\n| Stone | weighs down | Paper | causal | contextual inference |\n| Crossroads | symbolizes | Decision point | symbolic | cultural trope |\n| Desert | creates | Sense of isolation | emotional | contextual inference |\n| Paper | appears | Out of place | environmental | contextual inference |\n| Stone | represents | Permanence | symbolic | associative logic |\n| Paper | represents | Transience | symbolic | associative logic |\n| Crossroads | suggests | Journey or travel | narrative | cultural trope |\n| Scene | evokes | Surrealism | symbolic | contextual inference |\n| Desert heat | threatens | Paper preservation | environmental | contextual inference |"
      ]
    },
    {
      "id": 45,
      "type": "ShowText",
      "pos": [
        754.2742309570312,
        -1059.5433349609375
      ],
      "size": [
        492.5682678222656,
        235.56826782226562
      ],
      "flags": {},
      "order": 11,
      "mode": 0,
      "inputs": [
        {
          "name": "text",
          "type": "STRING",
          "widget": {
            "name": "text"
          },
          "link": 69
        }
      ],
      "outputs": [
        {
          "name": "STRING",
          "shape": 6,
          "type": "STRING",
          "links": null
        }
      ],
      "title": "prompt modification",
      "properties": {
        "cnr_id": "comfyui-show-text",
        "ver": "1.0.2",
        "Node name for S&R": "ShowText"
      },
      "widgets_values": [
        "",
        "| Entity 1 | Relation | Entity 2 | Relation Type |\n|----------|----------|----------|--------------|\n| Sponge | underneath | Metal | spatial |\n| Metal | floating above | Dead end | spatial |\n| Dead end | excluded from | Wetland | spatial |\n| Wetland | darkened by | Moon | property |\n| Sponge | is sheltered from | Strong wind | property |\n| Metal | is sheltered from | Strong wind | property |\n| Wetland | experiences | Winter night | temporal |\n| Dead end | avoids | Forest paths | spatial |\n| Moon | creates | Darkness | causal |\n| Wetland | characterized by | Cold | property |\n\n| Subject | Inferred Relation | Object / Value | Type | Source |\n|---------|-------------------|----------------|------|--------|\n| Scene | reveals | Movement | environmental | visual cue |\n| Sponge | is lifted by | Metal | causal | contextual inference |\n| Dead end | misrepresents | Certainty | symbolic | cultural trope |\n| Wetland | creates | Sense of community | emotional | contextual inference |\n| Metal | is inherently | Belonging | environmental | contextual inference |\n| Sponge | represents | Transience | symbolic | associative logic |\n| Metal | represents | Permanence | symbolic | associative logic |\n| Dead end | suggests | Stasis | narrative | cultural trope |\n| Scene | evokes | Realism | symbolic | contextual inference |\n| Wetland cold | safeguards | Metal preservation | environmental | contextual inference |"
      ]
    },
    {
      "id": 46,
      "type": "ShowText",
      "pos": [
        669.3324584960938,
        263.9596862792969
      ],
      "size": [
        466.8822937011719,
        329.3779296875
      ],
      "flags": {},
      "order": 13,
      "mode": 0,
      "inputs": [
        {
          "name": "text",
          "type": "STRING",
          "widget": {
            "name": "text"
          },
          "link": 70
        }
      ],
      "outputs": [
        {
          "name": "STRING",
          "shape": 6,
          "type": "STRING",
          "links": null
        }
      ],
      "title": "resulting prompt",
      "properties": {
        "cnr_id": "comfyui-show-text",
        "ver": "1.0.2",
        "Node name for S&R": "ShowText"
      },
      "widgets_values": [
        "",
        "moonlit winter wetland, frigid night, ethereal blue glow, tarnished metal object hovering, natural sponge underneath, abrupt dead end path, area sheltered from howling wind, distant misty forest silhouettes, wide-angle perspective, still water reflections, crystalline frost patterns, haunting atmosphere, deep indigo shadows, photorealistic details, subtle movement in reeds"
      ]
    },
    {
      "id": 49,
      "type": "ai4artsed_openrouter_key",
      "pos": [
        -391.9677734375,
        -353.01904296875
      ],
      "size": [
        441,
        26
      ],
      "flags": {},
      "order": 4,
      "mode": 0,
      "inputs": [],
      "outputs": [
        {
          "name": "STRING",
          "type": "STRING",
          "links": [
            73,
            74,
            77
          ]
        }
      ],
      "properties": {
        "aux_id": "joeriben/ai4artsed_comfyui",
        "ver": "fe64c5c981a6053532151e879437df25061dd945",
        "Node name for S&R": "ai4artsed_openrouter_key"
      },
      "widgets_values": []
    },
    {
      "id": 28,
      "type": "PrimitiveString",
      "pos": [
        -277.11468505859375,
        38.56100845336914
      ],
      "size": [
        728.9432373046875,
        66.43585205078125
      ],
      "flags": {},
      "order": 5,
      "mode": 0,
      "inputs": [],
      "outputs": [
        {
          "name": "STRING",
          "type": "STRING",
          "links": [
            66
          ]
        }
      ],
      "title": "Provide a context: neutral",
      "properties": {
        "cnr_id": "comfy-core",
        "ver": "0.3.27",
        "Node name for S&R": "PrimitiveString"
      },
      "widgets_values": [
        "2000 characters maximum"
      ],
      "color": "#232",
      "bgcolor": "#353"
    }
  ],
  "links": [
    [
      1,
      4,
      0,
      3,
      0,
      "MODEL"
    ],
    [
      2,
      5,
      0,
      3,
      3,
      "LATENT"
    ],
    [
      3,
      4,
      1,
      6,
      0,
      "CLIP"
    ],
    [
      4,
      6,
      0,
      3,
      1,
      "CONDITIONING"
    ],
    [
      5,
      4,
      1,
      7,
      0,
      "CLIP"
    ],
    [
      6,
      7,
      0,
      3,
      2,
      "CONDITIONING"
    ],
    [
      7,
      3,
      0,
      8,
      0,
      "LATENT"
    ],
    [
      8,
      4,
      2,
      8,
      1,
      "VAE"
    ],
    [
      9,
      8,
      0,
      9,
      0,
      "IMAGE"
    ],
    [
      65,
      40,
      0,
      42,
      0,
      "STRING"
    ],
    [
      66,
      28,
      0,
      42,
      1,
      "STRING"
    ],
    [
      67,
      42,
      0,
      6,
      1,
      "STRING"
    ],
    [
      69,
      40,
      0,
      45,
      0,
      "STRING"
    ],
    [
      70,
      42,
      0,
      46,
      0,
      "STRING"
    ],
    [
      72,
      48,
      0,
      40,
      1,
      "STRING"
    ],
    [
      73,
      49,
      0,
      40,
      2,
      "STRING"
    ],
    [
      74,
      49,
      0,
      42,
      2,
      "STRING"
    ],
    [
      75,
      47,
      0,
      50,
      0,
      "STRING"
    ],
    [
      76,
      50,
      0,
      40,
      0,
      "STRING"
    ],
    [
      77,
      49,
      0,
      50,
      1,
      "STRING"
    ],
    [
      78,
      50,
      0,
      51,
      0,
      "STRING"
    ]
  ],
  "groups": [],
  "config": {},
  "extra": {
    "ds": {
      "scale": 0.9849732675807631,
      "offset": [
        805.5309556452897,
        1124.8195925405792
      ]
    }
  },
  "version": 0.4
}