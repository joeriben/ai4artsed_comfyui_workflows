{"id":"9b590823-e4f8-4d7b-bedd-c1a89d6d1db2","revision":0,"last_node_id":43,"last_link_id":65,"nodes":[{"id":20,"type":"CLIPLoader","pos":[3711.84375,547.2083740234375],"size":[315,106],"flags":{},"order":0,"mode":0,"inputs":[{"localized_name":"clip_name","name":"clip_name","type":"COMBO","widget":{"name":"clip_name"},"link":null},{"localized_name":"type","name":"type","type":"COMBO","widget":{"name":"type"},"link":null},{"localized_name":"device","name":"device","shape":7,"type":"COMBO","widget":{"name":"device"},"link":null}],"outputs":[{"localized_name":"CLIP","name":"CLIP","type":"CLIP","links":null}],"properties":{"Node name for S&R":"CLIPLoader","cnr_id":"comfy-core","ver":"0.3.36"},"widgets_values":["clip_g.safetensors","stable_diffusion","default"]},{"id":39,"type":"CLIPLoader","pos":[763.6103515625,-704.7828369140625],"size":[270,106],"flags":{},"order":1,"mode":0,"inputs":[{"localized_name":"clip_name","name":"clip_name","type":"COMBO","widget":{"name":"clip_name"},"link":null},{"localized_name":"type","name":"type","type":"COMBO","widget":{"name":"type"},"link":null},{"localized_name":"device","name":"device","shape":7,"type":"COMBO","widget":{"name":"device"},"link":null}],"outputs":[{"localized_name":"CLIP","name":"CLIP","type":"CLIP","links":[57,58]}],"title":"Models without CLIP need this","properties":{"Node name for S&R":"CLIPLoader"},"widgets_values":["clip_g.safetensors","sd3","default"],"color":"#232","bgcolor":"#353"},{"id":6,"type":"CLIPTextEncode","pos":[294.6488952636719,-550.9696044921875],"size":[422.84503173828125,164.31304931640625],"flags":{},"order":14,"mode":0,"inputs":[{"localized_name":"clip","name":"clip","type":"CLIP","link":57},{"localized_name":"text","name":"text","type":"STRING","widget":{"name":"text"},"link":65}],"outputs":[{"localized_name":"CONDITIONING","name":"CONDITIONING","type":"CONDITIONING","slot_index":0,"links":[4]}],"properties":{"Node name for S&R":"CLIPTextEncode","cnr_id":"comfy-core","ver":"0.3.28"},"widgets_values":["A banner showing DEFAULT PROMPT, EINGABE FEHLGESCHLAGEN"],"color":"#322","bgcolor":"#533"},{"id":7,"type":"CLIPTextEncode","pos":[296.8141174316406,-333.2173767089844],"size":[425.27801513671875,180.6060791015625],"flags":{},"order":7,"mode":0,"inputs":[{"localized_name":"clip","name":"clip","type":"CLIP","link":58},{"localized_name":"text","name":"text","type":"STRING","widget":{"name":"text"},"link":null}],"outputs":[{"localized_name":"CONDITIONING","name":"CONDITIONING","type":"CONDITIONING","slot_index":0,"links":[6]}],"properties":{"Node name for S&R":"CLIPTextEncode","cnr_id":"comfy-core","ver":"0.3.28"},"widgets_values":["text, watermark"],"color":"#322","bgcolor":"#533"},{"id":8,"type":"VAEDecode","pos":[803.9498291015625,-217.10202026367188],"size":[210,46],"flags":{},"order":16,"mode":0,"inputs":[{"localized_name":"samples","name":"samples","type":"LATENT","link":7},{"localized_name":"vae","name":"vae","type":"VAE","link":8}],"outputs":[{"localized_name":"IMAGE","name":"IMAGE","type":"IMAGE","slot_index":0,"links":[9]}],"properties":{"Node name for S&R":"VAEDecode","cnr_id":"comfy-core","ver":"0.3.28"},"widgets_values":[],"color":"#322","bgcolor":"#533"},{"id":9,"type":"SaveImage","pos":[1107.2933349609375,-699.735595703125],"size":[626.985595703125,683.2880249023438],"flags":{},"order":17,"mode":0,"inputs":[{"localized_name":"images","name":"images","type":"IMAGE","link":9},{"localized_name":"filename_prefix","name":"filename_prefix","type":"STRING","widget":{"name":"filename_prefix"},"link":null}],"outputs":[],"properties":{"cnr_id":"comfy-core","ver":"0.3.28"},"widgets_values":["ComfyUI"]},{"id":37,"type":"PrimitiveStringMultiline","pos":[-1477.517333984375,-771.42138671875],"size":[806.9450073242188,211.6782989501953],"flags":{},"order":2,"mode":0,"inputs":[{"localized_name":"value","name":"value","type":"STRING","widget":{"name":"value"},"link":null}],"outputs":[{"localized_name":"STRING","name":"STRING","type":"STRING","links":[56]}],"title":"Just a more convenient input for your prompt","properties":{"Node name for S&R":"PrimitiveStringMultiline"},"widgets_values":["Ein Werbeplakat mit der Aufschrift NICHT DEIN PROMPT auf einer grünen Wiese"],"color":"#232","bgcolor":"#353"},{"id":40,"type":"Note","pos":[-589.064208984375,-1042.7188720703125],"size":[677.2032470703125,249.54833984375],"flags":{},"order":3,"mode":0,"inputs":[],"outputs":[],"title":"How to use this template","properties":{},"widgets_values":["Nach dem Öffnen direkt im Menü am unteren Bildrand: \"Workflow -> Save as\"\nspeichern als \n\nDeinSelbstgewähltesKürzel_WORKFLOW-NAME_timecode  (timecode = JahrMonatTagStundeMinute, z.B. 2506100949)\n\nz.B. BenJoe_SCHERENSCHNITT_2506100953\n\nNeue Versionen: einfach \"Save as\" und den timecode anpassen.\n\nDas originale Template sicherheitshalber schließen (untere Bildrand, Reiter -> X - Zeichen). Alle unsere Workflows sind gesichert; Ihr könnt also nicht wichtiges löschen! ;-)\n\nWenn Euer Workflow im \"Werkraum\" eingestellt werden soll, gebt uns bitte Bescheid!\n"],"color":"#432","bgcolor":"#653"},{"id":4,"type":"CheckpointLoaderSimple","pos":[297.7765808105469,-704.416015625],"size":[417.40997314453125,102.49164581298828],"flags":{},"order":4,"mode":0,"inputs":[{"localized_name":"ckpt_name","name":"ckpt_name","type":"COMBO","widget":{"name":"ckpt_name"},"link":null}],"outputs":[{"localized_name":"MODEL","name":"MODEL","type":"MODEL","slot_index":0,"links":[1]},{"localized_name":"CLIP","name":"CLIP","type":"CLIP","slot_index":1,"links":[]},{"localized_name":"VAE","name":"VAE","type":"VAE","slot_index":2,"links":[8]}],"title":"Choose your checkpoint ( = image generation model)","properties":{"Node name for S&R":"CheckpointLoaderSimple","cnr_id":"comfy-core","ver":"0.3.28"},"widgets_values":["OfficialStableDiffusion/sd3.5_large.safetensors"],"color":"#232","bgcolor":"#353"},{"id":5,"type":"EmptyLatentImage","pos":[413.6336975097656,-113.32685852050781],"size":[315,106],"flags":{},"order":5,"mode":0,"inputs":[{"localized_name":"width","name":"width","type":"INT","widget":{"name":"width"},"link":null},{"localized_name":"height","name":"height","type":"INT","widget":{"name":"height"},"link":null},{"localized_name":"batch_size","name":"batch_size","type":"INT","widget":{"name":"batch_size"},"link":null}],"outputs":[{"localized_name":"LATENT","name":"LATENT","type":"LATENT","slot_index":0,"links":[2]}],"properties":{"Node name for S&R":"EmptyLatentImage","cnr_id":"comfy-core","ver":"0.3.28"},"widgets_values":[1024,1024,1],"color":"#322","bgcolor":"#533"},{"id":3,"type":"KSampler","pos":[770.9010620117188,-536.1773681640625],"size":[300.6266784667969,474],"flags":{},"order":15,"mode":0,"inputs":[{"localized_name":"model","name":"model","type":"MODEL","link":1},{"localized_name":"positive","name":"positive","type":"CONDITIONING","link":4},{"localized_name":"negative","name":"negative","type":"CONDITIONING","link":6},{"localized_name":"latent_image","name":"latent_image","type":"LATENT","link":2},{"localized_name":"seed","name":"seed","type":"INT","widget":{"name":"seed"},"link":null},{"localized_name":"steps","name":"steps","type":"INT","widget":{"name":"steps"},"link":null},{"localized_name":"cfg","name":"cfg","type":"FLOAT","widget":{"name":"cfg"},"link":null},{"localized_name":"sampler_name","name":"sampler_name","type":"COMBO","widget":{"name":"sampler_name"},"link":null},{"localized_name":"scheduler","name":"scheduler","type":"COMBO","widget":{"name":"scheduler"},"link":null},{"localized_name":"denoise","name":"denoise","type":"FLOAT","widget":{"name":"denoise"},"link":null}],"outputs":[{"localized_name":"LATENT","name":"LATENT","type":"LATENT","slot_index":0,"links":[7]}],"properties":{"Node name for S&R":"KSampler","cnr_id":"comfy-core","ver":"0.3.28"},"widgets_values":[392371737554951,"randomize",25,5.5,"euler","normal",1],"color":"#322","bgcolor":"#533"},{"id":34,"type":"ai4artsed_prompt_interception","pos":[-1488.2978515625,-324.0515441894531],"size":[400,376],"flags":{},"order":9,"mode":4,"inputs":[{"localized_name":"input_prompt","name":"input_prompt","type":"STRING","widget":{"name":"input_prompt"},"link":50},{"localized_name":"input_context","name":"input_context","type":"STRING","widget":{"name":"input_context"},"link":null},{"localized_name":"style_prompt","name":"style_prompt","type":"STRING","widget":{"name":"style_prompt"},"link":null},{"localized_name":"api_key","name":"api_key","type":"STRING","widget":{"name":"api_key"},"link":51},{"localized_name":"model","name":"model","type":"COMBO","widget":{"name":"model"},"link":null},{"localized_name":"debug","name":"debug","type":"COMBO","widget":{"name":"debug"},"link":null},{"localized_name":"unload_model","name":"unload_model","type":"COMBO","widget":{"name":"unload_model"},"link":null}],"outputs":[{"localized_name":"output_str","name":"output_str","type":"STRING","links":[53]},{"localized_name":"output_float","name":"output_float","type":"FLOAT","links":null},{"localized_name":"output_int","name":"output_int","type":"INT","links":null},{"localized_name":"output_binary","name":"output_binary","type":"BOOLEAN","links":null}],"title":"AI4ArtsEd Translation_english","properties":{"Node name for S&R":"ai4artsed_prompt_interception"},"widgets_values":["","professional translator","Translate the prompt into English with maximal semantic preservation. \nMaintain the original structure, and preserve all culturally specific terms or non-translatable phrases in their original form. \nDo not translate proper names, ritual terms, or material names unless they have a common English usage. \nMark such terms with double brackets, e.g. [[egungun]], and preserve their position. \nDo not paraphrase, interpret, or summarize. Do not add any comments or explanations.\nReturn only the translated prompt as plain text.","","local/mistral:7b","enable","yes"],"color":"#322","bgcolor":"#533"},{"id":33,"type":"PreviewAny","pos":[-1071.2510986328125,-319.5638732910156],"size":[419.2315673828125,362.6350402832031],"flags":{},"order":11,"mode":0,"inputs":[{"localized_name":"source","name":"source","type":"*","link":53}],"outputs":[],"title":"input translation","properties":{"Node name for S&R":"PreviewAny","cnr_id":"comfy-core","ver":"0.3.39"},"widgets_values":[]},{"id":41,"type":"PreviewAny","pos":[-372.4936218261719,-274.71826171875],"size":[383.2861633300781,321.3395690917969],"flags":{},"order":12,"mode":0,"inputs":[{"localized_name":"source","name":"source","type":"*","link":60}],"outputs":[],"title":"Safety-filtered positive prompt","properties":{"Node name for S&R":"PreviewAny"},"widgets_values":[]},{"id":26,"type":"PrimitiveString","pos":[-1488.910400390625,-504.844970703125],"size":[826.6832275390625,109.9383544921875],"flags":{},"order":8,"mode":0,"inputs":[{"localized_name":"value","name":"value","type":"STRING","widget":{"name":"value"},"link":56}],"outputs":[{"localized_name":"STRING","name":"STRING","type":"STRING","links":[50,61]}],"title":"ai4artsed_text_prompt","properties":{"Node name for S&R":"PrimitiveString","cnr_id":"comfy-core","ver":"0.3.36"},"widgets_values":["Ein Banner mit der Aufschrift ACHTUNG DEFAULT-PROMPT!"],"color":"#322","bgcolor":"#533"},{"id":11,"type":"ai4artsed_openrouter_key","pos":[-1479.5887451171875,113.46794891357422],"size":[441,26],"flags":{},"order":6,"mode":0,"inputs":[],"outputs":[{"localized_name":"STRING","name":"STRING","type":"STRING","links":[51,63]}],"properties":{"Node name for S&R":"ai4artsed_openrouter_key","aux_id":"joeriben/ai4artsed_comfyui","ver":"e511931edb551d65374c44689e76c08794ed31e7"},"widgets_values":[],"color":"#322","bgcolor":"#533"},{"id":42,"type":"ai4artsed_switch_promptsafety","pos":[-381.05609130859375,-536.354736328125],"size":[400,200],"flags":{},"order":10,"mode":0,"inputs":[{"localized_name":"model_override","name":"model_override","shape":7,"type":"STRING","link":null},{"localized_name":"prompt","name":"prompt","type":"STRING","widget":{"name":"prompt"},"link":61},{"localized_name":"filter_level","name":"filter_level","type":"COMBO","widget":{"name":"filter_level"},"link":null},{"localized_name":"model","name":"model","type":"COMBO","widget":{"name":"model"},"link":null},{"localized_name":"api_key","name":"api_key","type":"STRING","widget":{"name":"api_key"},"link":63},{"localized_name":"unload_model","name":"unload_model","type":"COMBO","widget":{"name":"unload_model"},"link":null}],"outputs":[{"localized_name":"filtered_prompt","name":"filtered_prompt","type":"STRING","links":[60,64]}],"properties":{"Node name for S&R":"ai4artsed_switch_promptsafety"},"widgets_values":["","off","openrouter/mistralai/mistral-nemo [multilingual / $0.01/$0.001]","","yes"],"color":"#322","bgcolor":"#533"},{"id":43,"type":"PrimitiveStringMultiline","pos":[243.87521362304688,-1044.3043212890625],"size":[1031.4151611328125,173.70166015625],"flags":{},"order":13,"mode":0,"inputs":[{"localized_name":"value","name":"value","type":"STRING","widget":{"name":"value"},"link":64}],"outputs":[{"localized_name":"STRING","name":"STRING","type":"STRING","links":[65]}],"title":"Interceptive context - REPLACE THIS AS YOU SEE FIT (default is meant for the AI4ArtsEd web-interface)","properties":{"Node name for S&R":"PrimitiveStringMultiline"},"widgets_values":["You are a semantic filter in a child-oriented image generation system.\n\nYour task is to examine incoming prompts and assess whether they contain elements that may induce psychological fear or emotional distress in children, such as:\n- ghostlike or faceless figures\n- demonic or supernatural entities\n- threatening presence during sleep\n- death, violence, abduction, or horror tropes\n- explicit or implicit references to being watched, hunted, or taken\n\nIf such elements are present in a way that would likely evoke fear or distress in children, do **not** attempt to reframe or modify the prompt.  \nInstead, **completely discard the original input** and replace it with the following prompt, designed to gently signal the issue to the user:\n\n---\n\"A small, slightly frightened kitten sitting in front of a computer screen. The screen displays the friendly message: 'Sorry, too scary.' The kitten looks mildly alarmed but safe. The room is softly lit and calm, conveying a sense of emotional protection and empathy. The style is warm, painterly, and simple, without cartoon exaggeration or cuteness overload. No horror, no sarcasm, no parody.\"\n---\n\nIf the input is not problematic, return it unchanged.\n"],"color":"#232","bgcolor":"#353"}],"links":[[1,4,0,3,0,"MODEL"],[2,5,0,3,3,"LATENT"],[4,6,0,3,1,"CONDITIONING"],[6,7,0,3,2,"CONDITIONING"],[7,3,0,8,0,"LATENT"],[8,4,2,8,1,"VAE"],[9,8,0,9,0,"IMAGE"],[50,26,0,34,0,"STRING"],[51,11,0,34,3,"STRING"],[53,34,0,33,0,"*"],[56,37,0,26,0,"STRING"],[57,39,0,6,0,"CLIP"],[58,39,0,7,0,"CLIP"],[60,42,0,41,0,"*"],[61,26,0,42,1,"STRING"],[63,11,0,42,4,"STRING"],[64,42,0,43,0,"STRING"],[65,43,0,6,1,"STRING"]],"groups":[{"id":2,"title":"ai4artsed standard prompt input and translation","bounding":[-1498.910400390625,-845.0213623046875,856.890869140625,994.489501953125],"color":"#3f789e","font_size":24,"flags":{}},{"id":3,"title":"ai4artsed output sd3.5","bounding":[284.6489562988281,-778.3828125,1459.6298828125,782.7643432617188],"color":"#3f789e","font_size":24,"flags":{}},{"id":4,"title":"Prompt-safety switch","bounding":[-391.05609130859375,-609.9546508789062,420,666.5762939453125],"color":"#3f789e","font_size":24,"flags":{}}],"config":{},"extra":{"ds":{"scale":0.6830134553650705,"offset":[1176.3018111894276,1215.604422935479]}},"version":0.4}